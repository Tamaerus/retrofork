import{j as e,g as N,c as n,G as y,n as z,L as T,o as P,p as f,r as p,t as m,S as j,q as v,i as b,l as k}from"./index-ip7HRRnz.js";function w(s){return e.jsx("div",{className:"grid grid-rows-2 grid-flow-col-dense auto-cols-max pr-20",children:s.games.map(t=>{var i,u,x,h,g;const o=(i=t.metadata)==null?void 0:i.backgroundUrl,l=(u=t.metadata)==null?void 0:u.coverUrl,a=(x=t.metadata)==null?void 0:x.minutesPlayed,r=a?a>60?`Played for ${Math.floor(a/60)}h ${a%60}m`:`Played for ${a}m`:"Not played yet",d=o??l,c=((h=t.metadata)==null?void 0:h.name)??N(t.path);return e.jsx("div",{className:n("aspect-video h-[12rem] max-h-[12rem] p-2",d===l&&"row-span-2 h-[24rem] max-h-[24rem] aspect-[3/4]","first:row-span-2 first:h-[24rem] first:max-h-[24rem] first:pl-0"),children:e.jsxs("div",{className:n("relative w-full h-full group","rounded-lg overflow-hidden",!d&&"border"),children:[e.jsx("div",{className:n("absolute inset-0 bg-gradient-to-t from-card to-card/20 pointer-events-none touch-none","opacity-0 group-hover:opacity-100 transition-opacity"),children:e.jsxs("div",{className:n("absolute left-3 bottom-3 w-[90%] overflow-hidden overflow-ellipsis"),children:[e.jsx("h3",{className:"whitespace-nowrap text-lg font-bold",children:(g=t.metadata)==null?void 0:g.name}),e.jsx("h5",{className:"text-sm text-muted-foreground mb-2",children:r}),e.jsx(y,{gameId:t.id,children:e.jsx("div",{className:"rounded-md overflow-hidden w-fit pointer-events-auto touch-auto z-50",children:e.jsx(z,{size:"sm",className:'text-md min-w-[100px] [&_div[role="progressbar"]_>_*]:bg-primary-foreground',game:t})})})]})}),e.jsx(T,{to:"/games/$gameId",params:{gameId:t.id.toString()},className:"cursor-pointer",children:e.jsxs("div",{className:"relative w-full h-full z-[-1] bg-muted",children:[e.jsx("div",{className:"absolute inset-0 p-4 text-center grid place-items-center z-[-2]",children:e.jsx("h3",{className:"text-2xl font-black text-muted-foreground/50",children:c})}),d?e.jsx(P,{src:d,alt:"",className:n("object-cover h-full w-full rounded-lg mx-auto z-[-1] bg-transparent","scale-100 group-hover:scale-[110%] transition-transform")}):null]})})]})},t.id)})})}function R(){const{data:s,status:t}=f({request:{withMetadata:!0}}),o=p.useMemo(()=>s==null?void 0:s.games.map(l=>{var a;return{...l,metadata:(a=s.metadata)==null?void 0:a.find(r=>r.gameId===l.id)}}).sort((l,a)=>{const r=m(l.createdAt).getTime();return m(a.createdAt).getTime()-r}).slice(0,20),[s])??[];return e.jsxs("div",{className:"w-full",children:[e.jsx("h1",{className:"font-black text-3xl mb-5",children:"Recently Added"}),e.jsxs("div",{className:"relative flex w-full",children:[e.jsxs(j,{className:"w-1 flex-1 pb-2 overflow-x-auto",children:[t==="pending"?e.jsx(v,{className:"h-64 w-full rounded-lg"}):t==="error"?e.jsx("div",{className:"h-64 w-full grid place-items-center bg-muted/50 text-muted-foreground",children:"Could not load game data"}):o.length?e.jsx(w,{games:o}):e.jsx("div",{className:"h-64 w-full grid place-items-center bg-muted/50 text-muted-foreground",children:"No games found"}),e.jsx(b,{orientation:"horizontal",className:"z-30"})]}),e.jsx("div",{className:n("absolute inset-y-0 right-0 w-16 bg-gradient-to-l from-background","z-20 pointer-events-none touch-none")})]})]})}function A(){const{data:s,status:t}=f({request:{withMetadata:!0}}),o=p.useMemo(()=>s==null?void 0:s.games.map(l=>{var a;return{...l,metadata:(a=s.metadata)==null?void 0:a.find(r=>r.gameId===l.id)}}).sort((l,a)=>{var c,i;const r=m((c=l.metadata)==null?void 0:c.lastPlayed).getTime();return m((i=a.metadata)==null?void 0:i.lastPlayed).getTime()-r}).slice(0,20),[s])??[];return e.jsxs("div",{className:"w-full",children:[e.jsx("h1",{className:"font-black text-3xl mb-5",children:"Recently Played"}),e.jsxs("div",{className:"relative flex w-full",children:[e.jsxs(j,{className:"w-1 flex-1 pb-4 overflow-x-auto",children:[t==="pending"?e.jsx(v,{className:"h-64 w-full rounded-lg"}):t==="error"?e.jsx("div",{className:"h-64 w-full grid place-items-center bg-muted/50 text-muted-foreground",children:"Could not load game data"}):o.length?e.jsx(w,{games:o}):e.jsx("div",{className:"h-64 w-full grid place-items-center bg-muted/50 text-muted-foreground",children:"No games found"}),e.jsx(b,{orientation:"horizontal",className:"z-30"})]}),e.jsx("div",{className:n("absolute inset-y-0 right-0 w-16 bg-gradient-to-l from-background","z-20 pointer-events-none touch-none")})]})]})}const M=k("/(windowed)/_layout/home")({component:I});function I(){return e.jsxs("section",{className:"flex flex-col gap-5",children:[e.jsx(R,{}),e.jsx(A,{})]})}export{M as Route};
