import{u,a as v,r as m,j as e,F as y,c as d,b,d as w,H as N,g as k,I as E,e as I,f as F,h as x,A as C,S as j,i as L,k as A,L as S,l as G,m as R}from"./index-ip7HRRnz.js";import{S as T,B as z}from"./index-Cqywbane.js";const{BACKGROUND:h,COVER:_}=E;function H(i){const{games:s}=i,{activeGroup:a}=u(),{columns:r,gap:o}=v(n=>{var t,c,f;return(f=(c=(t=n.config)==null?void 0:t.interface)==null?void 0:c.fullscreenConfig)==null?void 0:f.gridList})??{columns:4,gap:20},l=m.useCallback(n=>{const t=n%r,c=Math.floor(n/r);return(1+Math.sqrt(t*t+c*c))*150},[r]);return e.jsx(y,{initialFocus:!0,opts:{focusKey:"game-list",forceFocus:!0},style:{"--game-cols":r,"--game-gap":`${o}px`},className:d("w-[70%] mx-auto py-[30dvh]","grid gap-[var(--game-gap)] grid-cols-[repeat(var(--game-cols),minmax(0,1fr))]"),children:s==null?void 0:s.map((n,t)=>e.jsx("div",{style:{animationDelay:`${l(t)}ms`},className:"animate-in fade-in fill-mode-both duration-500",children:e.jsx(M,{game:n,id:`game-list-${a==null?void 0:a.id}-${t}`})},n.id))})}function M(i){const{game:s,id:a}=i,r=b(),{ref:o,focusSelf:l}=w({focusKey:a,onFocus:({node:t})=>{t==null||t.focus({preventScroll:!0}),t==null||t.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})}}),{imageType:n}=v(t=>{var c,f,g;return(g=(f=(c=t.config)==null?void 0:c.interface)==null?void 0:f.fullscreenConfig)==null?void 0:g.gridList})??{imageType:_};return m.useEffect(()=>{a.endsWith("-0")&&l()},[l,a]),e.jsx("div",{className:d("group scale-95 focus-within:scale-100 hover:scale-100 transition-all","shadow-lg shadow-background relative cursor-pointer","ring-ring focus-within:ring-4 rounded h-full w-full"),children:e.jsx(N,{handlers:{ACCEPT:{handler:()=>{var t;return(t=o.current)==null?void 0:t.click()}}},children:e.jsx("div",{tabIndex:-1,id:a,ref:o,className:"border-none outline-none",onClick:()=>void r({to:"/fullscreen/games/$gameId",params:{gameId:s.id.toString()}}),children:e.jsx(P,{game:s,kind:n})})})})}function P(i){var n,t,c;const{game:s}=i,a=i.kind===h?(n=s.metadata)==null?void 0:n.backgroundUrl:(t=s.metadata)==null?void 0:t.coverUrl,[r,o]=m.useState(!a),l=((c=s.metadata)==null?void 0:c.name)??k(s.path);return e.jsxs("div",{className:d(i.kind===h?"aspect-video":"aspect-[3/4]","rounded overflow-hidden relative","h-fit w-fit min-w-full min-h-full"),children:[a&&e.jsx("img",{loading:"lazy",src:a,onError:()=>{o(!0)},className:d("absolute object-cover min-w-full min-h-full",r&&"hidden")}),e.jsx("div",{className:d(!r&&"opacity-0 translate-y-2 transition-all","group-hover:opacity-100 group-hover:translate-y-0 group-focus-within:opacity-100 group-focus-within:translate-y-0","absolute inset-0","bg-gradient-to-t from-card",i.kind===h?"text-lg py-2 px-4":"text-2xl p-4","flex items-end font-black"),children:e.jsx("p",{className:"text-pretty",children:l})})]},s.id)}const p="groupMenu";function B(i){const{previousGroup:s,nextGroup:a,allGroups:r}=u(),o=b();I({id:p});const l=m.useMemo(()=>({PAGE_LEFT:{handler:()=>o({search:n=>({...n,activeGroupId:s==null?void 0:s.id})}),zone:"groupMenu"},PAGE_RIGHT:{handler:()=>o({search:n=>({...n,activeGroupId:a==null?void 0:a.id})}),zone:"groupMenu"}}),[o,s,a]);return F({handlers:l}),e.jsx("div",{...i,children:e.jsx("div",{className:d("animate-in fade-in w-full"),children:e.jsxs("div",{className:d("w-full relative","flex items-center","pointer-events-auto touch-auto"),children:[e.jsx("div",{className:"pr-2 w-full border-r justify-self-start flex basis-1",children:e.jsx(x,{hotkey:"PAGE_LEFT",disabled:(s==null?void 0:s.id)===void 0,onClick:l.PAGE_LEFT.handler,children:e.jsx(C,{className:"ml-2"})})}),e.jsxs(j,{scrollRestorationId:p,className:d("relative w-full flex-grow","before:absolute before:inset-y-0 before:left-0 before:w-1/5 before:z-10","after:absolute after:inset-y-0 after:right-0 after:w-1/5","before:bg-gradient-to-l before:from-transparent before:to-background","after:bg-gradient-to-r after:from-transparent after:to-background","after:pointer-events-none before:pointer-events-none","after:touch-none before:touch-none"),children:[e.jsx("div",{className:d("whitespace-nowrap w-max px-[100%]","grid grid-flow-col place-items-center gap-4"),children:r==null?void 0:r.map(n=>e.jsx($,{group:n},n.id))}),e.jsx(L,{orientation:"horizontal",className:"hidden"})]}),e.jsx("div",{className:"pl-2 w-full border-l flex justify-end basis-1",children:e.jsx(x,{variant:"ghost",hotkey:"PAGE_RIGHT",className:"flex-row-reverse",disabled:(a==null?void 0:a.id)===void 0,onClick:l.PAGE_RIGHT.handler,children:e.jsx(A,{className:"mr-2"})})})]})})})}function $(i){const{group:s}=i,a=m.useRef(null),{activeGroup:r}=u(),o=(r==null?void 0:r.id)===s.id;return m.useEffect(()=>{o&&setTimeout(()=>{var l;(l=a.current)==null||l.scrollIntoView({behavior:"smooth",inline:"center"})},200)},[o,s]),e.jsx(S,{ref:a,className:d("text-2xl font-bold px-4 transition-all uppercase","opacity-30 hover:opacity-75",o&&"opacity-100 hover:opacity-100"),search:{activeGroupId:s.id},children:s.name})}function D(i){const{children:s,className:a,...r}=i;return e.jsx("div",{className:d("bg-background border-t px-2 py-3 max-w-full","flex items-end justify-center overflow-hidden",a),...r,children:s})}const O=G("/_fullscreenLayout/fullscreen/")({component:K});function K(){const{activeGroup:i,allGroups:s}=u();return e.jsxs("div",{className:"max-h-full h-fit flex flex-col overflow-hidden flex-grow",children:[e.jsxs(j,{className:"h-full relative",children:[e.jsx("div",{className:"absolute inset-0 z-[-1]",children:e.jsx(T,{children:e.jsx(z,{})})}),e.jsx("div",{className:"relative",children:s.map(a=>(i==null?void 0:i.id)===a.id?e.jsx(H,{games:a.games},a.id):e.jsx(e.Fragment,{},a.id))}),e.jsx(R,{orientation:"vertical",className:"z-[100]"})]}),e.jsx(D,{className:"fixed bottom-0 inset-x-0 overflow-hidden max-w-screen",children:e.jsx(B,{className:"w-full"})})]})}export{O as Route};
